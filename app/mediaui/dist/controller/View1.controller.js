sap.ui.define(["sap/ui/core/mvc/Controller"],function(e){"use strict";return e.extend("com.satya.mediaui.controller.View1",{onInit:function(){},onAfterRendering:function(){var e=this.getOwnerComponent().getModel("mainModelV2");this.getView().setModel(e)},handleUploadComplete:function(e){var t=e.getParameter("response"),o=/\d{4}/.exec(t),n=o&&parseInt(o[0]),a;if(t){a=n===200?t+" (Upload Success)":t+" (Upload Error)";MessageToast.show(a)}},beforeUploadStart:function(e){console.log("beforeUploadStart")},handleUploadPress:function(e){var t=this.byId("fileUploader");var o=t.getHeaderParameters();let n=this.getOwnerComponent().getModel("mainModelV2");n.read("/Media/$count",{success:function(e){console.log("count",e);++e;let o=t.getProperty("value");const a=this._fnCreateUploadID(n,e,o,"image/png");let r="/odata/v4/media-server/Media("+e+")/content";let i=t.getUploadUrl();t.setUploadUrl(r);t.checkFileReadable().then(function(){t.upload()},function(e){MessageToast.show("The file cannot be read. It may have changed.")}).then(function(){t.clear()})}.bind(this),error:function(e){}.bind(this)})},handleLinkPress:function(e){let t=e.getSource().getBindingContext().getObject();let o=window.location.origin;let n=o+`/odata/v4/media-server/Media(${t.id})/content`;console.log("URL",n);e.getSource().setHref(n)},_fnCreateUploadID:function(e,t,o,n){let a={id:t,fileName:o,applicationName:"app1",mediaType:n};e.create("/Media",a,null,{success:function(e,t){console.log("Create successful");resolve(e)},error:function(){console.log("Create failed");reject("Error")}})}})});